<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9M2PJU Battery Drain Calculator - Estimate Battery Life for Ham Radio</title>
  <meta name="description" content="A clean and modern battery drain calculator for ham radio and electronics. Estimate runtime based on mAh, voltage, current, duty cycle, and power efficiency." />
  <meta name="keywords" content="kira bateri, jangka hayat bateri, radio amatur, malaysia, calculator bateri, kalkulator, battery drain calculator, battery runtime estimator, ham radio battery tool, 9M2PJU, Malaysia ham radio, mAh to hours calculator, portable power calculator, amateur radio battery usage, battery life estimator" />
  <meta name="author" content="9M2PJU" />
  <link rel="icon" href="assets/favicon.png" type="image/png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    }
  </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-md mx-auto">
    <div class="bg-white dark:bg-gray-800 shadow-xl rounded-2xl p-6 space-y-6">
      <div class="flex justify-between items-center">
        <h1 class="text-2xl font-bold">
          üîã 9M2PJU Battery Drain Calculator
        </h1>
        <button onclick="toggleTheme()" class="text-sm px-3 py-1 rounded bg-gray-200 dark:bg-gray-700">
          Toggle Theme
        </button>
      </div>

      <div class="space-y-4">
        <div>
          <label class="block font-semibold mb-1">Battery Capacity (mAh)</label>
          <input id="capacity" type="number" class="w-full p-2 rounded border dark:border-gray-700 bg-gray-50 dark:bg-gray-700" placeholder="default: 5000" />
        </div>

        <div>
          <label class="block font-semibold mb-1">Drain Current (mA)</label>
          <input id="drain" type="number" class="w-full p-2 rounded border dark:border-gray-700 bg-gray-50 dark:bg-gray-700" placeholder="default: 1000" />
        </div>

        <div>
          <label class="block font-semibold mb-1">Battery Voltage (V) <span class="text-sm text-gray-500">(optional)</span></label>
          <input id="voltage" type="number" step="0.1" class="w-full p-2 rounded border dark:border-gray-700 bg-gray-50 dark:bg-gray-700" placeholder="default: 12" />
        </div>

        <div>
          <label class="block font-semibold mb-1">Duty Cycle (%) <span class="text-sm text-gray-500">(optional)</span></label>
          <input id="duty" type="number" step="1" class="w-full p-2 rounded border dark:border-gray-700 bg-gray-50 dark:bg-gray-700" placeholder="default: 50" />
        </div>

        <div>
          <label class="block font-semibold mb-1">Efficiency (%) <span class="text-sm text-gray-500">(optional)</span></label>
          <input id="efficiency" type="number" step="1" class="w-full p-2 rounded border dark:border-gray-700 bg-gray-50 dark:bg-gray-700" placeholder="default: 90" />
        </div>

        <button onclick="calculate()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg">
          ‚ö° Calculate Runtime
        </button>

        <div id="result" class="text-center mt-4 space-y-2">
          <div id="runtime" class="text-xl font-bold text-green-600 dark:text-green-400"></div>
          <div id="details" class="text-sm text-gray-700 dark:text-gray-300"></div>
        </div>

        <!-- Chart Canvas -->
        <canvas id="runtimeChart" class="w-full mt-6 hidden"></canvas>
      </div>
    </div>

    <p class="mt-6 text-sm text-center text-gray-500 dark:text-gray-400">
      Estimate how long your battery will last based on mAh, voltage, current drain, duty cycle, and power efficiency.
      <br>Made by <a href="https://hamradio.my" class="underline">9M2PJU</a> üá≤üáæ
    </p>
  </div>

  <script>
    function calculate() {
      const mAh = parseFloat(document.getElementById('capacity').value);
      const current_mA = parseFloat(document.getElementById('drain').value);
      const voltage = parseFloat(document.getElementById('voltage').value) || 12;
      const duty = parseFloat(document.getElementById('duty').value) || 100;
      const efficiency = parseFloat(document.getElementById('efficiency').value) || 100;

      if (!mAh || !current_mA || current_mA === 0) {
        document.getElementById('runtime').innerText = "";
        document.getElementById('details').innerText = "Please enter valid capacity and drain current.";
        return;
      }

      const wattHours = (mAh / 1000) * voltage;
      const adjustedCurrentA = (current_mA / 1000) * (duty / 100) / (efficiency / 100);
      const runtimeHours = wattHours / adjustedCurrentA;

      const h = Math.floor(runtimeHours);
      const m = Math.round((runtimeHours - h) * 60);

      document.getElementById('runtime').innerText = `Estimated runtime: ${h}h ${m}m`;
      document.getElementById('details').innerHTML = `
        üîã Battery Watt-hours: <strong>${wattHours.toFixed(2)} Wh</strong><br>
        ‚ö° Adjusted Drain Current: <strong>${adjustedCurrentA.toFixed(3)} A</strong><br>
        ‚öôÔ∏è Duty Cycle: ${duty}% ‚Ä¢ Efficiency: ${efficiency}%
      `;

      // Generate chart data
      const chartData = [];
      for (let i = 100; i <= 2000; i += 100) {
        const adjI = (i / 1000) * (duty / 100) / (efficiency / 100);
        const runtime = wattHours / adjI;
        chartData.push({ x: i, y: parseFloat(runtime.toFixed(2)) });
      }

      // Show chart
      document.getElementById('runtimeChart').classList.remove('hidden');

      // Create or update Chart.js chart
      if (window.runtimeChart) {
        window.runtimeChart.data.datasets[0].data = chartData;
        window.runtimeChart.update();
      } else {
        const ctx = document.getElementById('runtimeChart').getContext('2d');
        window.runtimeChart = new Chart(ctx, {
          type: 'line',
          data: {
            datasets: [{
              label: 'Runtime (hours)',
              data: chartData,
              borderColor: 'rgb(34, 197, 94)',
              backgroundColor: 'rgba(34, 197, 94, 0.2)',
              fill: true,
              tension: 0.3,
            }]
          },
          options: {
            responsive: true,
            scales: {
              x: {
                type: 'linear',
                title: {
                  display: true,
                  text: 'Drain Current (mA)'
                },
                ticks: {
                  stepSize: 200
                }
              },
              y: {
                title: {
                  display: true,
                  text: 'Runtime (hours)'
                },
                beginAtZero: true
              }
            },
            plugins: {
              legend: {
                display: false
              }
            }
          }
        });
      }
    }

    function toggleTheme() {
      document.documentElement.classList.toggle('dark');
    }
  </script>
</body>
</html>
